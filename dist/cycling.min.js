!function(){var e={886:function(){}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";n(886);let e=[];function t(t,n,c){const r=document.getElementById("calendar");r.innerHTML="";["一","二","三","四","五","六","日"].forEach((e=>{const t=document.createElement("div");t.className="calendar-week-header",t.innerText=e,r.appendChild(t)}));const l=i().toISOString().split("T")[0];let d=new Date(n);d.setUTCHours(0,0,0,0),e=[];let u=null;function m(t,n){const i=document.createElement("div");i.className="day-container";const o=document.createElement("span");o.className="date-number",o.innerText=t.getUTCDate(),i.appendChild(o);const a=n.find((e=>e.activity_time===t.toISOString().split("T")[0]));a&&e.push(a);const s=a?Math.min(parseFloat(a.riding_distance)/4,24):2,c=document.createElement("div");return c.className="activity-indicator",c.style.width=`${s}px`,c.style.height=`${s}px`,a||c.classList.add("no-activity"),c.style.left="50%",c.style.top="50%",i.appendChild(c),i.addEventListener("mouseenter",(()=>{t.toDateString()===(new Date).toDateString()?(o.style.opacity="0",c.style.opacity="1"):u&&(u.querySelector(".date-number").style.opacity="0",u.querySelector(".activity-indicator").style.opacity="1")})),i.addEventListener("mouseleave",(()=>{t.toDateString()===(new Date).toDateString()?(o.style.opacity="1",c.style.opacity="0"):u&&(u.querySelector(".date-number").style.opacity="1",u.querySelector(".activity-indicator").style.opacity="0")})),t.toDateString()===(new Date).toDateString()&&(u=i,i.classList.add("today"),c.style.backgroundColor="#242428",o.style.color="#242428",o.style.opacity="1",c.style.opacity="0"),i}(async function(){for(let e=0;e<c;e++)for(let e=0;e<7;e++){if(d.toISOString().split("T")[0]>l)return;const e=m(d,t);r.appendChild(e),await new Promise((e=>setTimeout(e,30))),d.setUTCDate(d.getUTCDate()+1)}})().then((()=>{!function(){const t=document.getElementById("barChart");t.innerHTML="";a(i(),21);const n={};e.forEach((e=>{const t=function(e){const t=e.getDay(),n=(0===t?-6:1)-t,i=new Date(e);return i.setDate(i.getDate()+n),i}(new Date(e.activity_time)),i=new Date(t);i.setDate(t.getDate()+6);const o=`${t.toISOString().split("T")[0]} - ${i.toISOString().split("T")[0]}`;n[o]=(n[o]||0)+parseFloat(e.riding_distance)}));const s=Math.max(...Object.values(n),0);Object.keys(n).forEach((e=>{const i=document.createElement("div");i.className="bar-container";const a=document.createElement("div");a.className="bar";const c=n[e]/s*190;a.style.setProperty("--bar-width",`${c}px`);const r=document.createElement("div");r.className="cycling-kilometer",r.innerText="0 km";const l=o(),d=o();i.style.position="relative",a.appendChild(r),i.appendChild(a),i.appendChild(l),i.appendChild(d),t.appendChild(i),a.style.width="0",a.offsetHeight,a.style.transition="width 1s ease-out",a.style.width=`${c}px`,r.style.opacity="1",function(e,t,n,i,o=!1){const a=performance.now();function s(){const t=performance.now()-a,c=Math.min(t/i,1),r=(c*n).toFixed(2);e.innerText=o?`${r} km`:`${r}h`,c<1?requestAnimationFrame(s):e.innerText=o?`${n.toFixed(2)} km`:`${n.toFixed(2)}h`}s()}(r,0,n[e],1e3,!0),function(e,t,n,i){let o,a;e.addEventListener("mouseenter",(()=>{clearTimeout(o),clearTimeout(a);const e=i>140?"这周干的还不错":"偷懒了啊";t.innerText=e,t.classList.add("show"),a=setTimeout((()=>{t.classList.remove("show")}),700)})),e.addEventListener("mouseleave",(()=>{o=setTimeout((()=>{t.classList.remove("show")}),700)})),e.addEventListener("click",(()=>{n.innerText="一起来运动吧！",n.classList.add("show"),setTimeout((()=>{n.classList.remove("show")}),700),t.classList.remove("show"),clearTimeout(o),clearTimeout(a)}))}(a,l,d,n[e])}))}(),function(){const t=document.getElementById("totalCount"),n=document.getElementById("milesRiddenThisYear"),i=document.getElementById("totalTitle");if(!t||!n||!i)return;const o=t.querySelector("#ridingTimeThisYearValue"),a=n.querySelector("#milesRiddenThisYearValue"),c=t.querySelector(".loading-spinner"),r=n.querySelector(".loading-spinner");c.classList.add("active"),r.classList.add("active");const l=(new Date).getFullYear();i.textContent=`${l} 骑行总时长`;const d=e.filter((e=>new Date(e.activity_time).getFullYear()===l)),u=d.reduce(((e,t)=>e+parseFloat(t.moving_time)||0),0),m=function(e){return e.reduce(((e,t)=>e+parseFloat(t.riding_distance)||0),0)}(d);s(o,u,1e3,50,!1),s(a,m,1e3,50,!0),setTimeout((()=>{console.log(m.toFixed(2)),o.textContent=`${u.toFixed(2)} h`,a.textContent=`${m.toFixed(2)} km`,c.classList.remove("active"),r.classList.remove("active")}),1e3)}()}))}function i(){const e=new Date;return new Date(e.getTime()+288e5)}function o(){const e=document.createElement("div");return e.className="message-box",e}function a(e,t){const n=e.getUTCDay(),i=0===n?6:n-1,o=new Date(e);return o.setUTCDate(e.getUTCDate()-i-t),o}function s(e,t,n,i,o=!1){const a=t/(n/i);let s=0;const c=setInterval((()=>{s+=a,s>=t&&(s=t,clearInterval(c)),e.textContent=o?`${s.toFixed(2)} km`:`${s.toFixed(2)} h`}),i);setTimeout((()=>{e.textContent=o?`${t.toFixed(2)} km`:`${t.toFixed(2)} h`}),n)}!async function(){const e=a(i(),21);t(await async function(){return(await fetch("https://cos.lhasa.icu/data/cycling_data.json")).json()}(),e,4)}()}()}();